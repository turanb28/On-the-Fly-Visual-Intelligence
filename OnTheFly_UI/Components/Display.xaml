<UserControl x:Class="OnTheFly_UI.Components.Display"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:OnTheFly_UI.Components"
             xmlns:converters="clr-namespace:OnTheFly_UI.Components.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" x:Name="main">

    <UserControl.Resources>

        <Style x:Key="styleListBoxItem" TargetType="{x:Type ListBoxItem}">
            <Setter Property="OverridesDefaultStyle" Value="True"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <Grid x:Name="grid"  >

                            <Border x:Name="background" BorderThickness="0" Opacity="1" Background="{StaticResource Foreground_Light}" ></Border>

                            <ContentPresenter Margin="10"  ></ContentPresenter>

                        </Grid>
                        <ControlTemplate.Triggers>

                            <EventTrigger RoutedEvent="ListBoxItem.MouseEnter">
                                    <BeginStoryboard>
                                        <Storyboard>
                                     
                                        <ColorAnimation Storyboard.TargetName="background" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="{StaticResource Color_Foreground_Dark}" Duration="0:0:0.1"  />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            <EventTrigger RoutedEvent="ListBoxItem.MouseLeave">
                                    <BeginStoryboard>
                                        <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="background" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="{StaticResource Color_Foreground_Light}" Duration="0:0:0.1"  />
                                    </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                          
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ResultTableListBoxStyle" TargetType="{x:Type ListBox}" >

            <Setter Property="Opacity" Value="0.4"></Setter>
            <Style.Triggers>
                <EventTrigger RoutedEvent="ListBox.MouseEnter">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.1" />
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
                <EventTrigger RoutedEvent="ListBox.MouseLeave">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0.4" Duration="0:0:0.1" />
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
               
            </Style.Triggers>
        </Style>


        <Style x:Key="listitemTextBlock" TargetType="{x:Type TextBlock}">
            <Setter Property="FontWeight" Value="Medium"  ></Setter>
            <Setter Property="VerticalAlignment" Value="Center"  ></Setter>
            <Setter Property="Background" Value="Transparent"  ></Setter>
            <Setter Property="Foreground" Value="White"  ></Setter>

        </Style>

        <converters:DoubleConverter x:Key="doubleConverter"/>
        <converters:PleasantStringConverter x:Key="pleasantStringConverter"/>
       

    </UserControl.Resources>

         <Grid x:Name="border"  ClipToBounds="True" MouseMove="main_MouseMove"  MouseWheel="main_MouseWheel" MouseLeftButtonDown="main_MouseLeftButtonDown" MouseLeftButtonUp="border_MouseLeftButtonUp" MouseRightButtonDown="border_MouseRightButtonDown" Width="{Binding ElementName=main, Path=ActualWidth}" Height="{Binding ElementName=main, Path=ActualHeight}" Background="Transparent">
             <Canvas x:Name="objectCanvas" RenderTransformOrigin="0.5,0.5" >
            <Image  x:Name="displayImage" Width="{Binding ElementName=objectCanvas, Path=ActualWidth}" Height="{Binding ElementName=objectCanvas, Path=ActualHeight}"  Source="{Binding ElementName=main, Path=Source, UpdateSourceTrigger=PropertyChanged}" Canvas.Top="0" Canvas.Left="0" ></Image>
        </Canvas>
             
             
        <ListBox Name="resultTableListbox"  VerticalAlignment="Top" HorizontalAlignment="Left" ItemContainerStyle="{StaticResource styleListBoxItem}"
                 BorderThickness="0"   Margin="5" Style="{StaticResource ResultTableListBoxStyle}"  Background="{StaticResource Foreground_Light}"
                 ItemsSource="{Binding ElementName=main, Path=ResultTable}">
     
            <ListBox.ItemTemplate>
                <DataTemplate >

                    <Grid x:Name="itemGrid" Width="{Binding ElementName=border, Path=ActualWidth, Converter={StaticResource doubleConverter},ConverterParameter=0.12}"  Visibility="Visible" >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="{Binding Name,UpdateSourceTrigger=PropertyChanged, Converter={StaticResource pleasantStringConverter}}"    TextAlignment="Left"    Style="{StaticResource listitemTextBlock}" />
                        <TextBlock Grid.Column="1" Text="{Binding Count,UpdateSourceTrigger=PropertyChanged}"  TextAlignment="Center"  Style="{StaticResource listitemTextBlock}" />

                        <Button Grid.Column="2" VerticalAlignment="Center" Click="Button_Click"  
                                Width="{Binding ElementName=border, Path=ActualWidth, Converter={StaticResource doubleConverter},ConverterParameter=0.015}" Height="{Binding ElementName=border, Path=ActualWidth, Converter={StaticResource doubleConverter},ConverterParameter=0.015}" >

                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="BorderThickness" Value="1"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    <Setter Property="Padding" Value="1"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ButtonBase}">
                                                <Border x:Name="border" SnapsToDevicePixels="true" Background="Transparent">

                                                    <Grid x:Name="contentPresenter">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*"></RowDefinition>
                                                        </Grid.RowDefinitions>
                                                        <Path  Stretch="Uniform"  Fill="{StaticResource Background_Dark}" >
                                                            <Path.Data>
                                                                <CombinedGeometry>
                                                                    <CombinedGeometry.Geometry1>
                                                                        <PathGeometry Figures="M 304.97266 60.011719 C 301.64345 59.975172 298.30563 60.017867 294.96094 60.138672 C 187.93081 64.004424 94.224141 145.76033 6.6503906 276.92188 A 40 40 0 0 0 0.4921875 296.11328 A 40 40 0 0 0 0.12695312 299.21094 A 40 40 0 0 0 0.82226562 305.09961 A 40 40 0 0 0 2.3222656 312.62891 A 40 40 0 0 0 2.9257812 313.93945 A 40 40 0 0 0 6.734375 322.21094 C 94.308126 453.37249 188.01285 535.13035 295.04297 538.99609 C 402.07309 542.86185 501.15054 465.95491 593.82422 321.61133 A 40 40 0 0 0 599.95898 296.71289 A 40 40 0 0 0 599.73242 294.32031 A 40 40 0 0 0 599.60938 293.48633 A 40 40 0 0 0 593.74219 277.52344 C 503.96456 137.69058 408.17803 61.144675 304.97266 60.011719 z M 297.84766 140.08594 C 360.4588 137.82452 432.32712 182.03757 512.4082 299.62891 C 432.36016 417.12988 360.5194 461.30947 297.92969 459.04883 C 235.76089 456.80339 163.96532 406.29087 88.212891 299.50781 C 163.93522 192.80364 235.70122 142.33057 297.84766 140.08594 z"></PathGeometry>
                                                                    </CombinedGeometry.Geometry1>
                                                                    <CombinedGeometry.Geometry2>
                                                                        <PathGeometry Figures="m 300,180 c -65.91876,0 -120,54.08124 -120,120 0,65.91876 54.08124,120 120,120 65.91876,0 120,-54.08124 120,-120 0,-65.91876 -54.08124,-120 -120,-120 z m 0,60 c 33.49239,0 60,26.50761 60,60 0,33.49239 -26.50761,60 -60,60 -33.49239,0 -60,-26.50761 -60,-60 0,-33.49239 26.50761,-60 60,-60 z"></PathGeometry>
                                                                    </CombinedGeometry.Geometry2>
                                                                </CombinedGeometry>
                                                            </Path.Data>
                                                        </Path>
                                                        <Path Stretch="Uniform" Fill="{StaticResource Background_Dark}" x:Name="hide_icon" Data="m 552.11521,19.567047 a 28.00006,28.00003 0 0 0 -19.79873,8.201311 L 28.315395,531.76895 a 28.00006,28.00003 0 0 0 0,39.59737 28.00006,28.00003 0 0 0 39.597479,0 L 571.91396,67.365795 a 28.00006,28.00003 0 0 0 0,-39.597437 28.00006,28.00003 0 0 0 -19.79875,-8.201311 z"></Path>

                                                    </Grid>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <DataTrigger Binding="{Binding IsHidden}" Value="True">
                                                        <Setter TargetName="hide_icon" Property="Visibility" Value="Hidden"/>
                                                    </DataTrigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                            
                            
                            
                        </Button>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>

        </ListBox>

        </Grid>

    <!--<CombinedGeometry>
    <CombinedGeometry.Geometry1>
        <PathGeometry Figures="M 304.97266 60.011719 C 301.64345 59.975172 298.30563 60.017867 294.96094 60.138672 C 187.93081 64.004424 94.224141 145.76033 6.6503906 276.92188 A 40 40 0 0 0 0.4921875 296.11328 A 40 40 0 0 0 0.12695312 299.21094 A 40 40 0 0 0 0.82226562 305.09961 A 40 40 0 0 0 2.3222656 312.62891 A 40 40 0 0 0 2.9257812 313.93945 A 40 40 0 0 0 6.734375 322.21094 C 94.308126 453.37249 188.01285 535.13035 295.04297 538.99609 C 402.07309 542.86185 501.15054 465.95491 593.82422 321.61133 A 40 40 0 0 0 599.95898 296.71289 A 40 40 0 0 0 599.73242 294.32031 A 40 40 0 0 0 599.60938 293.48633 A 40 40 0 0 0 593.74219 277.52344 C 503.96456 137.69058 408.17803 61.144675 304.97266 60.011719 z M 297.84766 140.08594 C 360.4588 137.82452 432.32712 182.03757 512.4082 299.62891 C 432.36016 417.12988 360.5194 461.30947 297.92969 459.04883 C 235.76089 456.80339 163.96532 406.29087 88.212891 299.50781 C 163.93522 192.80364 235.70122 142.33057 297.84766 140.08594 z"></PathGeometry>
    </CombinedGeometry.Geometry1>
    <CombinedGeometry.Geometry2>
        <PathGeometry Figures="m 300,180 c -65.91876,0 -120,54.08124 -120,120 0,65.91876 54.08124,120 120,120 65.91876,0 120,-54.08124 120,-120 0,-65.91876 -54.08124,-120 -120,-120 z m 0,60 c 33.49239,0 60,26.50761 60,60 0,33.49239 -26.50761,60 -60,60 -33.49239,0 -60,-26.50761 -60,-60 0,-33.49239 26.50761,-60 60,-60 z"></PathGeometry>
    </CombinedGeometry.Geometry2>
</CombinedGeometry>-->
    <!--<PathGeometry Figures="M 570,0 A 30,30 0 0 0 548.78711,8.7871094 L 8.7871094,548.78711 a 30,30 0 0 0 0,42.42578 30,30 0 0 0 42.4257816,0 L 591.21289,51.212891 a 30,30 0 0 0 0,-42.4257816 A 30,30 0 0 0 570,0 Z"></PathGeometry>-->


</UserControl>
